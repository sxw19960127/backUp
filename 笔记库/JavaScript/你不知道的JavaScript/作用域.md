# 作用域

- 引擎：负责整个`JavaScript`程序的编译及执行过程。
- 编译器：引擎的好朋友之一，负责语法分析及代码生成等脏活累活。
- 作用域：引擎的另一位好朋友，负责收集并维护由所有声明的标识符（变量）组成的一系列查询，并实施一套非常严格的规则，确定当前执行的代码对这些标识符的访问权限。

下面是对==var a = 1;==的解读：

- 编译器首先会将这段程序分解成词法单元，然后将词法单元解析成一个树结构。
- 编译器开始生成代码。

```
遇到var a,编译器会询问作用域是否已经有一个该名称的变量存在于同一个作用域的集合中。如果是,编译器会忽略该声明,继续进行编译;否则它会要求作用域在当前作用域的集合中声明一个新的变量,并命名为a。
接下来编译器会为引擎生成运行时所需的代码,这些代码被用来处理a=1这个赋值操作。引擎运行时会先询问作用域,在当前的作用域集合中是否存在一个叫做a的变量。如果是,引擎就会使用该变量;不是引擎会继续查找该变量。如果引擎最终找到了变量a,就会将1赋值给他。否则引擎就会举手示意并抛出异常。
```

总结：变量的赋值操作会执行两个动作，首先编译器会在当前作用域中声明一个变量（如果之前没有声明过），然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它进行赋值操作。



编译器在编译过程的第二步中生成了代码，引擎执行它时，会通过查找变量a来判断它是否已经声明过。查找的过程由作用域进行协助，但是引擎执行怎样的查找，会影响最终的查找结果。当变量出现在赋值操作的左侧时，进行`LHS`查询，出现在右侧时进行`RHS`查询。



**作用域嵌套**：//25